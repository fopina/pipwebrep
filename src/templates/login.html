{% extends "base.html" %}
{% block title %}Login{% endblock %}
{% block navbar %}{% endblock %}
{% block content %}
			<div class="row" style="margin-top:60px;">
				<div class="col-md-4 col-md-offset-4">
					<form method="POST" action="login" accept-charset="UTF-8" role="form" id="loginform" class="form-signin">
						<fieldset>
					  		<h2 class="sign-up-title">Please sign in</h2>
					  		<hr class="colorgraph">

						    <input class="form-control" placeholder="Username" name="username" type="text">
						    <input class="form-control" placeholder="Password" name="password" type="password" value="">
						    <hr class="colorgraph">
  							<select class="form-control" name="environ" id="environ">
						    </select>
						    <hr class="colorgraph">
						    <input class="btn btn-lg btn-success btn-block" type="submit" value="Login">
					  	</fieldset>
		  			</form>
		  		</div>
  			</div>

  			<!-- Modal -->
			<div class="modal fade" id="hostModal" tabindex="-1" role="dialog" aria-labelledby="hostModalLabel" aria-hidden="true">
			  <div class="modal-dialog">
			    <div class="modal-content">
			      <div class="modal-header">
			        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			        <h4 class="modal-title" id="hostModalLabel">Manage connections</h4>
			      </div>
			      	<div class="modal-body">
								<fieldset>
									<input name="squery" id="squery" type="hidden">
									<input name="confirmsave" id="confirmsave" type="hidden">
							  	</fieldset>
			      	</div>
				    <div class="modal-footer">
				      <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				      <button type="submit" class="btn btn-primary">Save</button>
				    </div>
			      </form>
			    </div>
			  </div>
			</div>
{% endblock %}
{% block scripts %}
<script>
	var listElem = localStorage.getItem('piprep_connections');
	if (listElem == null) {
		listElem = { '{{ config.CON_NAME }}' : '{{ config.HOST }}:{{ config.PORT }}'};
	}

	var environ = $("#environ");

	environ.empty();

	$.each(listElem, function(key, value) {
    	environ.append($("<option />").val(value).text(key));
	});

	environ.append($("<option disabled/>").text('-----------'));
	environ.append($("<option />").val('xxx').text('Manage connections'));

	var previousEnviron;
	$("#environ").one('focus', function () {
        previousEnviron = this.value;
    }).change(function() {
		var val = this.value;
		if (val == 'xxx') {
			$('#hostModal').modal('show');
			this.value = previousEnviron;
		};
	});
</script>
{% endblock %}